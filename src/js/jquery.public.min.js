(()=>{(function(t){t(function(){d(),t("input[type='number']").on("keydown",function(e){t.inArray(e.keyCode,[46,8,9,27,13,110,190])!==-1||e.ctrlKey===!0||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()});function y(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}t(".mt_email_check span").hide(),t("#mt_email2").on("keyup",function(){let e=t("#mt_email").val(),a=t("#mt_email2").val();a.length>3?y(e)?e==a&&y(e)?(t(".mt_email_check .ok").show(),t(".mt_email_check .mismatch, .mt_email_check .notemail").hide()):(t(".mt_email_check .mismatch").show(),t(".mt_email_check .ok, .mt_email_check .notemail").hide()):(t(".mt_email_check .notemail").show(),t(".mt_email_check .ok, .mt_email_check .mismatch").hide()):t(".mt_email_check *").hide()}),t(".mt_cart button:not(.mt-plugin,.mt-gateway-selector)").on("click",function(e){t('input[name="mt_submit"]').prop("disabled",!0),t(".mt-response").html('<p class="mt-response-processing">'+mt_ajax_cart.processing+"</p>").show(),e.preventDefault();let a=t(this).attr("class"),r=t(this).attr("rel"),i=t(this).attr("data-id"),o=t(this).attr("data-type"),l=t(r+" .mt_count").val(),n=t(r+" .count").attr("data-limit"),s;if(a=="more"?s=parseInt(l)+1:a=="less"?(parseInt(l)==0&&(s=0,t(r).addClass("removed")),s=parseInt(l)-1):(s=0,t(r).addClass("removed")),0>s&&(s=0),s>n&&a=="more")t(".mt-response").html("<p>"+mt_ajax_cart.max_limit+"</p>").show(300);else{t(r+" .mt_count").val(s),t(r+" span.count").text(s);let c=0,p=0;t("td .count").each(function(){if(t(this).is(":visible")){let u=t(this).text(),x=t(this).parent("td").children(".price").text();x=x.replace(mt_ajax_cart.thousands,""),c+=parseInt(u)*parseFloat(x),p+=parseInt(u)}});let f=parseFloat(c).toFixed(2).replace("/(d)(?=(d{3})+.)/g","$1,");t(".mt_total_number").text(mt_ajax.currency+f.toString());let k={action:mt_ajax_cart.action,data:{mt_event_id:i,mt_event_tickets:s,mt_event_type:o},security:mt_ajax_cart.security};t.post(mt_ajax_cart.url,k,function(u){u.success==1?(t(".mt-response").html("<p>"+u.response+"</p>").show(300),f<0||p<=0||t('input[name="mt_submit"]').prop("disabled",!1)):t(".mt-response").html('<p class="mt-response-error">'+u.response+"</p>").show(300)},"json")}}),t(".gateway-selector button").on("click",function(e){e.preventDefault(),t(".gateway-selector li").removeClass("active"),t(this).parent("li").addClass("active"),t(".gateway-selector button").removeAttr("aria-current"),t(this).attr("aria-current","true");let a=t(this).attr("data-assign"),r=mt_ajax_cart.handling[a];t(".mt_cart_handling .price").text(r),t('input[name="mt_gateway"]').val(a)}),t(".mt_save_shipping").on("click",function(e){t(".mt-processing").show();let a=t(".mt_street").val(),r=t(".mt_street2").val(),i=t(".mt_city").val(),o=t(".mt_state").val(),l=t(".mt_code").val(),n=t(".mt_country").val(),s={street:a,street2:r,city:i,state:o,code:l,country:n},c={action:mt_ajax.action,data:s,function:"save_address",security:mt_ajax.security};t.post(mt_ajax.url,c,function(p){let f=p.response;t(".mt-response").html("<p>"+f+"</p>").show(300)},"json"),t(".mt-processing").hide()});function d(){t(".mt-order .ticket-orders").each(function(){let a=t(this);a.find(".mt-ticket-field input:not([disabled]), .mt-ticket-field select:not([disabled])").length<1&&t('.mt-order button[name="mt_add_to_cart"]').parent("p").hide(),t(".mt-error-notice").hide(),a.on("blur",".tickets-field",function(){let i=0,o=0;t(this).val()==""&&t(this).val("0"),a.find(".tickets-remaining .value").each(function(){let l=parseInt(t(this).text());i=i+l}),a.find(".tickets_field").each(function(){if(!(t(this).attr("disabled")=="disabled")){let n=Number(t(this).val());o=o+n}}),o>i?a.find('button[name="mt_add_to_cart"]').addClass("mt-invalid-purchase").attr("disabled","disabled"):a.find('button[name="mt_add_to_cart"]').removeClass("mt-invalid-purchase").removeAttr("disabled")}),a.on("click",".mt-increment",function(){let i=t(this).parent(".mt-ticket-input").find("input"),o=parseInt(i.val()),l=parseInt(i.attr("max")),n=o+1;n<=l?i.val(n):(i.val(l),n=l),n=n.toString(),wp.a11y.speak(n,"assertive")}),a.on("click",".mt-decrement",function(){let i=t(this).parent(".mt-ticket-input").find("input"),o=parseInt(i.val()),l=parseInt(i.attr("min")),n=o-1;n>=l?i.val(n):(i.val(l),n=l),n=n.toString(),wp.a11y.speak(n,"assertive")}),a.on("click",'button[name="mt_add_to_cart"]',function(i){let o=[],l=!0;if(a.find(".ticket-orders *[required]").each(function(n,s){if(s.value||(l=!1,o.push(s)),s.type==="radio"){let c=!1;document.querySelectorAll(`.ticket-orders input[name=${s.name}]`).forEach(function(p){p.checked&&(c=!0)}),c||o.push(s),l=c}}),l){a.find(".mt-processing").show(),i.preventDefault();let n=t(this).closest(".ticket-orders").serialize(),s={action:mt_ajax.action,data:n,function:"add_to_cart",security:mt_ajax.security};t.post(mt_ajax.url,s,function(c){console.log(c),t("#mt-response-"+c.event_id).html("<p>"+c.response+"</p>").show(300).attr("tabindex","-1").trigger("focus"),c.success==1&&(mt_ajax.redirect=="0"?(t(".mt_qc_tickets").text(c.count),t(".mt_qc_total").text(parseFloat(c.total,10).toFixed(2).replace("/(d)(?=(d{3})+.)/g","$1,").toString())):window.location.replace(mt_ajax.cart_url))},"json"),a.find(".mt-processing").hide()}else{let n=t(this).parents(".mt-order").find(".mt-response"),s="";o.forEach(function(c,p){let f=c.id,k=t("label[for="+f+"]").text(),u='<li><a href="#'+f+'">'+k+"</a></li>";s+=u}),n.html("<p>"+mt_ajax.requiredFieldsText+"</p><ul>"+s+"</ul>")}})})}document.addEventListener("keydown",function(e){e.ctrlKey&&e.code==="Space"&&_()}),t(".mt-extend-button").on("click",function(e){_()});function _(){t(".mt-processing").show();let e={action:mt_ajax.action,function:"extend_cart",security:mt_ajax.security};t.post(mt_ajax.url,e,function(a){let r=t("#mt-timer"),i=a.response,l=r.data("start")+300;r.data("start",l),v(r),wp.a11y.speak(i)},"json"),t(".mt-processing").hide()}t(".mt-payment-form form").on("submit",function(e){t("#mt_unsubmitted").remove()}),t(".mt-payments button").on("click",function(e){let a=t(this).attr("aria-expanded")=="true",r=t(this).next(".mt-payment-details");a?(r.hide(),t(this).attr("aria-expanded","false")):(r.show(),t(this).attr("aria-expanded","true"))}),setTimeout(function(){setInterval(function(){let e=t(".mt-expiration-update").text();wp.a11y.speak(e)},1e3*60)},1e3);let h=t("#mt-timer");h.length!==0&&setInterval(v,1e3,h);function v(e){let a=e.data("start"),r=document.querySelector(".mt_cart");if(a>0){let i=a-1;e.data("start",i);let o=new Date(null);o.setSeconds(i);let l=o.getMinutes(),n=o.getSeconds();e.html(l+" minutes "+n+" seconds")}else e.parent().html(mt_ajax.cartExpired),t(".mt-extend-button").hide(),r.parentNode.removeChild(r)}});let m=t("#create-admin-payment");if(m.length>0){let y=m.attr("href"),d=new URL(y),_=t("#mt_fname"),h=t("#mt_lname"),v=t("#mt_email");_.on("blur",function(e){_.val()!==""&&(d.searchParams.append("fname",_.val()),m.attr("href",d.toString()))}),h.on("blur",function(e){h.val()!==""&&(d.searchParams.append("lname",h.val()),m.attr("href",d.toString()))}),v.on("blur",function(e){v.val()!==""&&(d.searchParams.append("email",v.val()),m.attr("href",d.toString()))})}})(jQuery);window.addEventListener("beforeunload",function(t){let m=document.getElementById("mt_unsubmitted");typeof m<"u"&&m!=null&&(t.preventDefault(),t.returnValue="")});})();
